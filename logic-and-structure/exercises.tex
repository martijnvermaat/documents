\documentclass[a4paper,11pt]{article}
\usepackage[english]{babel}
\usepackage{a4,fullpage}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{amsthm}
\usepackage[T1]{fontenc}
\usepackage{lmodern} % Latin modern font family
\usepackage[specials]{synttree} % http://www.matijs.net/software/synttree/

% Sans-serif fonts
%\usepackage[T1experimental,lm]{sfmath} % http://dtrx.de/od/tex/sfmath.html
%\renewcommand{\familydefault}{\sfdefault}

% Some configuration for listings
\renewcommand{\labelenumi}{\arabic{enumi}.}
\renewcommand{\labelenumii}{(\alph{enumii})}

\newcounter{firstcounter}
\newcommand{\labelfirst}{(\roman{firstcounter})}
%\newcommand{\spacingfirst}{\usecounter{firstcounter}\setlength{\rightmargin}{\leftmargin}}
\newcommand{\spacingfirst}{\usecounter{firstcounter}}

\newcounter{secondcounter}
\newcommand{\labelsecond}{(\arabic{secondcounter})}
%\newcommand{\spacingsecond}{\usecounter{secondcounter}\setlength{\rightmargin}{\leftmargin}}
\newcommand{\spacingsecond}{\usecounter{secondcounter}}


\title{Logic and Structure\\
\normalsize{Solutions to Selected Exercises (from Fourth Edition)}}

\author{Martijn Vermaat (mvermaat@cs.vu.nl)}
\date{Updated 5th December 2005}


\begin{document}

\maketitle


\section{Propositional Logic}


\subsection{Propositions and Connectives}


\begin{enumerate}

\item % 1
$p_{1}, p_{2}, p_{3}, \neg p_{2}, \neg p_{3}, p_{1} \leftrightarrow p_{2}, p_{3} \vee (p_{1} \leftrightarrow p_{2}),
\neg p_{2} \rightarrow (p_{3} \vee (p_{1} \leftrightarrow p_{2})),\\
(\neg p_{2} \rightarrow (p_{3} \vee (p_{1} \leftrightarrow p_{2}))) \wedge \neg p_{3}$.

$p_{1}, p_{2}, p_{4}, p_{7}, \bot, \neg \bot, p_{7} \rightarrow \neg \bot, \neg p_{2}, p_{4} \leftrightarrow \neg p_{2},
(p_{4} \leftrightarrow \neg p_{2}) \rightarrow p_{1},\\
(p_{7} \rightarrow \neg \bot) \leftrightarrow ((p_{4} \leftrightarrow \neg p_{2}) \rightarrow p_{1})$.

$p_{1}, p_{2}, p_{1} \rightarrow p_{2}, (p_{1} \rightarrow p_{2}) \rightarrow p_{1},
((p_{1} \rightarrow p_{2}) \rightarrow p_{1}) \rightarrow p_{2},
(((p_{1} \rightarrow p_{2}) \rightarrow p_{1}) \rightarrow p_{2}) \rightarrow p_{1}$.

\item % 2
Suppose $((\neg \in X$ and $X$ satisfies (i), (ii), and (iii) of Definition
1.1.2. Now $Y = X - \{((\neg\}$ is smaller than $X$ while still satisfying
those rules making $X$ not the smallest set satisfying them, hence $((\neg$
cannot be in $PROP$. (By the same reasoning as in the example on page 8.)

\item % 3
Let $\varphi, \psi$ be formulas. We use induction on $\chi$ to show
\begin{align*}
  \varphi \in Sub(\psi) \And \psi \in Sub(\chi) &\Rightarrow \varphi \in Sub(\chi)
\end{align*}
for all $\chi$. ($Sub$ as in Definition 1.1.7.)
\begin{list}{\labelfirst}{\spacingfirst}
\item $\chi$ is atomic, therefore $Sub(\chi) = \{\chi\}$. Suppose
$\varphi \in Sub(\psi)$ and $\psi \in \{\chi\}$. Now $\psi = \chi$ and
$Sub(\psi) = \{\chi\}$. So we also have $\varphi = \chi$ and thus
$\varphi \in Sub(\chi)$.

\item $\chi = \chi_{1} \square \chi_{2}$. By definition,
$Sub(\chi) = Sub(\chi_{1}) \cup Sub(\chi_{2}) \cup \{\chi_{1} \square \chi_{2}\}$.
Suppose $\varphi \in Sub(\psi)$ and $\psi \in Sub(\chi)$. Now we have three
cases:
  \begin{list}{\labelsecond}{\spacingsecond}
    \item $\psi \in Sub(\chi_{1})$. By induction we may assume
      $\varphi \in Sub(\chi_{1})$. Hence $\varphi \in Sub(\chi)$.
    \item $\psi \in Sub(\chi_{2})$. Like (1).
    \item $\psi = \chi_{1} \square \chi_{2}$. Now $\psi = \chi$
      and trivially $\varphi \in Sub(\chi)$.
  \end{list}

\item $\chi = \neg \chi_{1}$. Again by definition,
$Sub(\chi) = Sub(\chi_{1}) \cup \{\neg \chi_{1}\}$. Suppose $\varphi \in Sub(\psi)$
and $\psi \in Sub(\chi)$. We have two cases:
  \begin{list}{\labelsecond}{\spacingsecond}
    \item $\psi \in Sub(\chi_{1})$. Same as (1) in (ii).
    \item $\psi = \neg \chi_{1}$. Because $\psi = \chi$, also
      $\varphi \in Sub(\chi)$.
  \end{list}

\end{list}

By the Induction Principle we now have
$\varphi \in Sub(\psi) \And \psi \in Sub(\chi) \Rightarrow \varphi \in Sub(\chi)$
for all formulas $\chi$.

\item % 4
Let $\varphi \in Sub(\psi)$ and suppose $\psi_{0}, \ldots, \psi_{n}$ is a
formation sequence with $\psi_{n} = \psi$. We show
$\varphi \in \{\psi_{0}, \ldots, \psi_{n}\}$ by induction on $n$:
\begin{description}
\item{$n = 0$:} $\psi$ must be atomic, so $Sub(\psi) = \{\psi\}$. This
means $\varphi = \psi$ and hence we have $\varphi \in \{\psi_{0}, \ldots, \psi_{n}\}$.

\item{$n > 0$:} We consider possible structures for $\psi_{n}$:
  \begin{list}{\labelfirst}{\spacingfirst}
    \item $\psi_{n}$ is atomic. Same as $n = 0$ case above.
    \item $\psi = \psi_{a} \square \psi_{b}$. Note that $\psi_{a}$ and
      $\psi_{b}$ are in $\{\psi_{0}, \ldots, \psi_{n-1}\}$ (by Definition 1.1.4).
      Let $n_{a}, n_{b}$ be such that $\psi_{n_{a}} = \psi_{a}$ and
      $\psi_{n_{b}} = \psi_{b}$. Now,
      \begin{align*}
        Sub(\psi) &= Sub(\psi_{a}) \cup Sub(\psi_{b}) \cup \{\psi_{a} \square \psi_{b}\}
      \end{align*}
      which leaves three cases for $\varphi$:
        \begin{list}{\labelsecond}{\spacingsecond}
          \item $\varphi \in Sub(\psi_{a})$. By induction,
            $\varphi \in \{\psi_{0}, \ldots, \psi_{n_{a}}\}$ and thus
            $\varphi \in \{\psi_{0}, \ldots, \psi_{n}\}$.
          \item $\varphi \in Sub(\psi_{a})$. Same as (1).
          \item $\varphi = \psi_{a} \square \psi_{b}$. Now $\varphi = \psi$,
            so $\varphi \in \{\psi_{0}, \ldots, \psi_{n}\}$.
        \end{list}
    \item $\psi = \neg \psi_{a}$. Analogous to (ii).
  \end{list}
\end{description}

\item % 5
By induction on $\psi$ we show that $\varphi \in Sub(\psi)$ if $\varphi$ is in a shortest
formation sequence of $\varphi$.
\begin{list}{\labelfirst}{\spacingfirst}
\item Atomic $\psi$ has a shortest formation sequence $\psi$. If $\varphi$ is
  in this sequence, $\varphi = \psi$ and $\varphi \in Sub(\psi)$ (for
  $Sub(\psi) = \{\psi\}$).
\item Suppose $\varphi$ is in a shortest formation sequence of $\psi_{0} \square \psi_{1}$, then
  clearly $\varphi$ is in a shortest formation sequence of either $\psi_{0}$ or $\psi_{1}$, or
  $\varphi = \psi_{0} \square \psi_{1}$. We consider all three cases:
  \begin{list}{\labelsecond}{\spacingsecond}
    \item By induction $\varphi \in Sub(\psi_{0})$. Now,
      $Sub(\psi_{0} \square \psi_{1} = Sub(\psi_{0}) \cup Sub(\psi_{1}) \cup \{\psi_{0} \square \psi_{1}\}$
      and thus $\varphi \in Sub(\psi_{0} \square \psi_{1})$.
    \item Same as case (1).
    \item A formula is always a subformula of itself.
  \end{list}
\item Suppose $\varphi$ is in a shortest formation sequence of $\neg \psi$, then $\varphi$ is in
  a shortest formation sequence of $\psi$ or $\varphi = \neg \psi$. The two cases are handled like we did
  in (ii).
\end{list}

\item % 6
\begin{enumerate}
\item % 6a
We show that $r(\varphi) \leq$ number of occurrences of connectives of $\varphi$ ($c(\varphi)$) by
induction on $\varphi$:
  \begin{list}{\labelfirst}{\spacingfirst}
    \item For atomic $\varphi$, $r(\varphi) = 0$, $c(\varphi) \in \{0,1\}$.
    \item Let $r(\varphi_{0}) \leq c(\varphi_{0})$ and $r(\varphi_{1}) \leq c(\varphi_{1})$. Now
      $r(\varphi_{0} \square \varphi_{1}) = \text{max}(r(\varphi_{0}), r(\varphi_{1}) + 1)$ and
      $c(\varphi_{0} \square \varphi_{1}) = c(\varphi_{0}) + c(\varphi_{1}) + 1)$, so clearly
      $r(\varphi_{0} \square \varphi_{1}) \leq c(\varphi_{0} \square \varphi_{1})$.
    \item Like (ii).
  \end{list}
\item % 6b
  $r(\neg p_{6}) = c(\neg p_{6}) = 1$, $r(\neg p_{3} \wedge \neg p_{1}) < c(\neg p_{3} \wedge \neg p_{1})$.
\item % 6c
  $r((\neg p_{2} \rightarrow (p_{3} \vee (p_{1} \leftrightarrow p_{2}))) \wedge \neg p_{3}) = 4$,\\
  $r((p_{7} \rightarrow \neg \bot) \leftrightarrow ((p_{4} \leftrightarrow \neg p_{2}) \rightarrow p_{1})) = 4$,\\
  $r((((p_{1} \rightarrow p_{2}) \rightarrow p_{1}) \rightarrow p_{2}) \rightarrow p_{1}) = 4$.
\item % 6d
We use induction on $\psi$ to show $r(\varphi) < r(\psi)$ if $\varphi$ is a proper subformula of $\psi$:
\begin{list}{\labelfirst}{\spacingfirst}
\item For atomic $\psi$ there is no proper subformula $\varphi$.
\item Let $r(\varphi) < r(\psi_{0})$ if $\varphi$ is a proper subformula of $\psi_{0}$,
  $r(\varphi) < r(\psi_{1})$ if $\varphi$ is a proper subformula of $\psi_{1}$. Now suppose
  $\varphi$ is a proper subformula of $\psi_{0} \square \psi_{1}$. Then $\varphi$ is a
  subformula of $\psi_{0}$ or a subformula of $\psi_{1}$. We consider both cases:
  \begin{list}{\labelsecond}{\spacingsecond}
    \item $\varphi = \psi_{0}$ or $\varphi$ is a proper subformula of $\psi_{0}$. If the
      former, $r(\varphi) < r(\psi)$. If the latter, $r(\varphi) < r(\psi_{0})$ by our
      induction hypothesis, hence again $r(\varphi) < r(\psi)$.
    \item Analogous to (1).
  \end{list}
\item Like (ii).
\end{list}
\end{enumerate}

\item % 7
\begin{enumerate}
\item The trees for the three propositions in exercise 1:\\ % 7a
\parbox[t]{1.7in}{
\synttree[$\wedge$
  [$\rightarrow$
    [$\neg$[$p_{2}$]]
    [$\vee$
      [$p_{3}$]
      [$\leftrightarrow$[$p_{1}$][$p_{2}$]]
    ]
  ]
  [$\neg$[$p_{3}$]]
]}
\parbox[t]{1.75in}{
\synttree[$\leftrightarrow$
  [$\rightarrow$
    [$p_{7}$]
    [$\neg$[$\bot$]]
  ]
  [$\rightarrow$
    [$\wedge$
      [$p_{4}$]
      [$\neg$[$p_{2}$]]
    ]
    [$p_{1}$]
  ]
]}
\parbox[t]{1.6in}{
\synttree[$\rightarrow$
  [$\rightarrow$
    [$\rightarrow$
      [$\rightarrow$
        [$p_{1}$]
        [$p_{2}$]
      ]
      [$p_{1}$]
    ]
    [$p_{2}$]
  ]
  [$p_{1}$]
]}

\item % 7b
$\neg \neg \neg \bot$,\\
$(p_{0} \rightarrow \bot) \rightarrow ((p_{0} \leftrightarrow p_{1}) \wedge p_{5})$,\\
$\neg (\neg p_{1} \rightarrow \neg p_{1})$.
\end{enumerate}

\item % 8
\begin{enumerate}
\item % 8a
We use induction on $\varphi$ to show that $c(\varphi) + a(\varphi) \leq \#(T(\varphi))$
($c$ as in exercise 6a, $a(\varphi)$ gives the number of atoms of $\varphi$) given that
$\varphi$ does not contain $\bot$:
\begin{list}{\labelfirst}{\spacingfirst}
\item If $\varphi$ is atomic, $c(\varphi) + a(\varphi) = \#(T(\varphi)) = 1$.
\item Let $c(\varphi_{0}) + a(\varphi_{0}) \leq \#(T(\varphi_{0}))$ and
  $c(\varphi_{1}) + a(\varphi_{1}) \leq \#(T(\varphi_{1}))$. Now,
  \begin{align*}
    c(\varphi_{0} \square \varphi_{1}) + a(\varphi_{0} \square \varphi_{1}) &=
    c(\varphi_{0}) + c(\varphi_{1}) + 1 + a(\varphi_{0}) + a(\varphi_{1}) - n \quad \text{and}\\
    \#(T(\varphi_{0} \square \varphi_{1})) &= \#(T(\varphi_{0})) + \#(T(\varphi_{1})) + 1,
  \end{align*}
  where $n \leq 0$ is the number of atoms occuring in both $\varphi_{0}$ and $\varphi{1}$.
  This shows
  \begin{align*}
    c(\varphi_{0} \square \varphi_{1}) + a(\varphi_{0} \square \varphi_{1}) &\leq \#(T(\varphi_{0} \square \varphi_{1})).
  \end{align*}
\item Like (ii).
\end{list}

\item % 8b
$\#(Sub(\varphi)) \leq \#(T(\varphi))$ by induction on $\varphi$:
\begin{list}{\labelfirst}{\spacingfirst}
\item If $\varphi$ is atomic, $\#(Sub(\varphi)) = \#(T(\varphi)) = 1$.
\item Let $\#(Sub(\varphi_{0})) \leq \#(T(\varphi_{0}))$ and
  $\#(Sub(\varphi_{1})) \leq \#(T(\varphi_{1}))$. Now,
  \begin{align*}
    \#(Sub(\varphi_{0} \square \varphi_{1})) &\leq \#(Sub(\varphi_{0})) + \#(Sub(\varphi_{1})) + 1 \quad \text{and}\\
    \#(T(\varphi_{0} \square \varphi_{1})) &= \#(T(\varphi_{0})) + \#(T(\varphi_{1})) + 1.
  \end{align*}
  So clearly $\#(Sub(\varphi_{0} \square \varphi_{1})) \leq \#(T(\varphi_{0} \square \varphi_{1}))$.
\item $\#(Sub(\neg \varphi)) = \#(Sub(\varphi)) + 1$ and $\#(T(\neg \varphi)) = \#(T(\varphi)) + 1$, so
  \begin{align*}
    \#(Sub(\varphi)) \leq \#(T(\varphi)) &\Rightarrow \#(Sub(\neg \varphi)) \leq \#(T(\neg \varphi)).
  \end{align*}
\end{list}

\item % 8c
Notation: $depth(\varphi)$ is the length of a longest branch in $T(\varphi)$. We show
\begin{align*}
  r(\varphi) &= depth(\varphi)
\end{align*}
by induction on the rank of $\varphi$. Let $r(\psi) = depth(\psi)$ for all $\psi$ with $r(\psi) < r(\varphi)$. We
consider three cases for the structure of $\varphi$:
\begin{list}{\labelfirst}{\spacingfirst}
\item $\varphi$ is atomic. $r(\varphi) = depth(\varphi) = 0$.
\item $\varphi = \varphi_{0} \square \varphi_{1}$ with $r(\varphi_{0}), r(\varphi_{1}) < r(\varphi)$ (from
  exercise 6d). Now
  \begin{align*}
    depth(\varphi) &= \text{max}(depth(\varphi_{0}), depth(\varphi_{1})) + 1
  \end{align*}
  and by definition
  \begin{align*}
    r(\varphi) &= \text{max}(r(\varphi_{0}), r(\varphi_{1})) + 1.
  \end{align*}
  This shows $r(\varphi) = depth(\varphi)$.
\item Like (ii).
\end{list}
By the Induction on rank-Principle we have $r(\varphi) = depth(\varphi)$ (for all $\varphi$).

\item % 8d
We show $\#(T(\varphi)) \leq 2^{r(\varphi)+1}-1$ by induction on $\varphi$ (no restriction on occurrences of $\bot$):
\begin{list}{\labelfirst}{\spacingfirst}
\item If $\varphi$ is atomic, $\#(T(\varphi)) = 1$ and $2^{r(\varphi)+1}-1 = 2^{1}-1 = 1$.
\item Let $\#(T(\varphi)) \leq 2^{r(\varphi)+1}-1$ and $\#(T(\psi)) \leq 2^{r(\psi)+1}-1$. By definition,
  \begin{align*}
    \#(T(\varphi \square \psi)) &= \#(T(\varphi)) + \#(T(\psi)) + 1.
    \end{align*}
  Therefore
  \begin{align*}
    \#(T(\varphi \square \psi)) &\leq  2^{r(\varphi)+1} + 2^{r(\psi)+1} - 2
    \end{align*}
  and thus, by $2^{x} + 2^{y} \leq 2^{\text{max}(x,y)+1}$,
  \begin{align*}
    \#(T(\varphi \square \psi)) &\leq  2^{\text{max}(r(\varphi)+1,r(\psi)+1)+1} - 2.
  \end{align*}
  Now,
  \begin{align*}
    2^{r(\varphi \square \psi)+1}-1 &= 2^{\text{max}(r(\varphi),r(\psi))+2}-1.
  \end{align*}
  Clearly, $\#(T(\varphi \square \psi)) \leq  2^{r(\varphi \square \psi)+1}-1$.
\item Like (ii).
\end{list}
Using the result from 8c we have $c(\varphi) + a(\varphi) \leq 2^{r(\varphi)+1}-1$ for $\varphi$ not containing $\bot$.
\end{enumerate}

\item % 9
We show $\#(Sub(\varphi)) \leq 2 c(\varphi) + 1$ ($c$ as in exercise 6a) by induction on the rank of $\varphi$.
Assume $\#(Sub(\psi)) \leq 2 c(\psi) + 1$ for all $\psi$ with $r(\psi) < r(\varphi)$. We consider the structure
of $\varphi$ by case:
\begin{list}{\labelfirst}{\spacingfirst}
\item $\varphi$ is atomic. $\#(Sub(\varphi)) = 1$ and $2 c(\varphi) + 1 \geq 1$.
\item $\varphi = \varphi_{0} \square \varphi_{1}$. Now,
  \begin{align*}
    \#(Sub(\varphi)) &\leq \#(Sub(\varphi_{0})) + \#(Sub(\varphi_{1})) + 1 \quad \text{and}\\
    c(\varphi) &= c(\varphi_{0}) + c(\varphi_{1}) + 1.
  \end{align*}
  So, by our assumption,
  \begin{align*}
    \#(Sub(\varphi)) &\leq 2 c(\varphi_{0}) + 1 + 2 c(\varphi_{1}) + 1 + 1\\
                     &\leq 2 (c(\varphi_{0}) + c(\varphi_{1}) + 1) + 1\\
                     &\leq 2 c(\varphi) + 1.
  \end{align*}
\item Like (ii).
\end{list}
By the Induction on rank-Principle $\#(Sub(\varphi)) \leq 2 c(\varphi) + 1$ holds.

\item % 10
We have to show
\begin{align*}
  \sigma \in PROP \quad &\Longrightarrow \quad \sigma = \varphi \square \psi \quad \text{or} \quad \sigma = \neg \varphi
  \quad \text{(and not both), for $\varphi, \psi \in PROP$.}
\end{align*}
\begin{list}{\labelfirst}{\spacingfirst}
\item
Assume there is a set $X$ conforming to (i)-(iii) of Definition 1.1.2 with $\sigma \in X$ and
$\sigma \not = \varphi \square \psi$ and $\sigma \not = \neg \varphi$ for any $\varphi, \psi \in PROP$.
Conjecture: the set $X' = X - \{\sigma\}$ is smaller than $X$ while still conforming to the
same rules (i)-(iii).
TODO: work this out.
\item
Consider a proposition $\sigma \in PROP$. From Definition 1.1.2 it follows directly that
$\sigma = \varphi \square \psi = \neg \chi$ cannot be true (think about the brackets we
ommit by convention but are acutally still there).
\end{list}

\item % 11
\begin{enumerate}
\item % 11a
\item % 11b
\item % 11c
\item % 11d
\end{enumerate}

\end{enumerate}


\subsection{Semantics}


\end{document}
